# A/B-тестирование нового алгоритма рекомендаций

## Описание проекта
Компания разрабатывает развлекательное приложение с функцией «бесконечной» ленты, аналогичное приложениям с короткими видео. В приложении действуют две модели монетизации: ежемесячная платная подписка (без рекламы) и показ рекламы для пользователей без подписки.

Команда разработчиков создала новый алгоритм рекомендаций, который предположительно будет показывать более интересный контент для каждого пользователя. Задача — рассчитать параметры A/B-теста для проверки этой гипотезы и проанализировать его результаты.

**Цель исследования:** Оценить, приводит ли новый алгоритм рекомендаций к увеличению доли успешных сессий (просмотр 4 и более страниц за сессию).

## Навыки и инструменты
- **Python:** Pandas, Matplotlib, SciPy, StatsModels
- **Статистика:** A/B-тестирование, расчёт размера выборки, t-тест Уэлча, z-тест для пропорций
- **Метрики:** доля успешных сессий, количество сессий, регистрации пользователей

## Структура данных
В проекте использовались три датасета:

**`тут_была_ссылка`** — исторические данные за период 2025-08-11 — 2025-09-23:
- `user_id`, `session_id`, `session_date`, `session_start_ts`, `install_date`
- `session_number`, `registration_flag`, `page_counter`, `region`, `device`

**`тут_была_ссылка`** — данные за первый день теста (2025-10-14)

**`тут_была_ссылка`** — данные за весь период теста (2025-10-14 — 2025-11-02)

Поля тестовых таблиц включают дополнительный столбец `test_group` (A/B).

---

## Ход выполнения проекта

### 1. Анализ исторических данных

**1.1. Загрузка и первичный анализ**
- Загружены исторические данные о сессиях пользователей
- Найден пользователь с максимальным количеством сессий (10 сессий)

**1.2. Анализ регистраций**
- Построены графики динамики общего числа пользователей и зарегистрированных пользователей
- Доля зарегистрированных пользователей стабильно держится на уровне ~25-30%

**1.3. Анализ просмотров страниц**
- Большинство сессий (более 105 тыс.) имеют 2 просмотренные страницы
- Количество сессий убывает с ростом числа просмотренных страниц

**1.4. Метрика "успешная сессия"**
- Введена метрика `good_session = 1` при просмотре ≥4 страниц
- Доля успешных сессий колеблется в диапазоне 0.28-0.34, со слабым трендом к снижению к концу периода

---

### 2. Подготовка к тесту

**2.1. Формулировка гипотез**
- **Метрика:** доля успешных сессий (≥4 просмотренных страниц)
- **H₀:** Доля успешных сессий не изменилась после внедрения нового алгоритма
- **H₁:** Доля успешных сессий увеличилась после внедрения нового алгоритма

**2.2. Расчёт размера выборки**
- Уровень значимости (α): 0.05
- Мощность теста (1-β): 0.8
- MDE: 3% от базового уровня (0.3)
- **Необходимый размер выборки:** **41 040 пользователей** на каждую группу

**2.3. Расчёт длительности теста**
- Средний дневной трафик: **9 907 пользователей/день**
- Требуется охватить 82 080 пользователей (обе группы)
- **Длительность теста:** **9 дней**

---

### 3. Мониторинг A/B-теста (первые дни)

**3.1. Проверка распределения пользователей**
- Процентная разница между группами: **0.74%** (незначительно)
- Распределение близко к равномерному

**3.2. Проверка пересечений**
- Пересечений пользователей между группами **не обнаружено** (0 пользователей)
- Группы независимы

**3.3. Равномерность по устройствам**
- Распределение по типам устройств практически идентично в обеих группах
- Небольшие отклонения (до 1.7%) несущественны

**3.4. Равномерность по регионам**
- Распределение по регионам также равномерно
- Максимальное отклонение: 0.4%

**Вывод по мониторингу:** Тест проходит корректно, группы сбалансированы, нарушения не обнаружены.

---

### 4. Анализ результатов теста

**4.1. Проверка сопоставимости групп по количеству сессий**
- Проведён t-тест Уэлча для сравнения количества сессий по дням
- **p-value = 0.9382** — различий в количестве сессий между группами нет

**4.2. Сравнение доли успешных сессий**
- Группа A (контроль): **0.3077** (30.77%)
- Группа B (тест): **0.3183** (31.83%)
- Разница: **+1.06 п.п.**

**4.3. Статистическая значимость**
- Проведён z-тест для пропорций
- **p-value = 0.0003** (< 0.05)
- Изменение статистически значимо

---

## Итоговые выводы

### Характеристики эксперимента
- Общее количество пользователей в тесте: **82 080** (по 41 040 в каждой группе)
- Фактическая длительность теста: **20 дней** (с 2025-10-14 по 2025-11-02)
- Ключевая метрика: доля успешных сессий (≥4 просмотренных страниц)

### Результаты
1. **Проверка корректности теста:**
   - Группы сбалансированы по размеру (разница 0.74%)
   - Пересечений пользователей между группами нет
   - Распределение по устройствам и регионам равномерно
   - Количество сессий по дням статистически не различается (p=0.9382)

2. **Влияние на ключевую метрику:**
   - Доля успешных сессий выросла с **30.77%** до **31.83%**
   - Абсолютный прирост: **+1.06 п.п.**
   - Относительный прирост: **+3.4%**
   - **Статистическая значимость:** p-value = 0.0003

### Рекомендация
✅ **Новый алгоритм рекомендаций показал статистически значимое улучшение ключевой метрики. Рекомендуется внедрить его в приложение.**

---

## Файлы
- `ab_test_analysis.ipynb` — Jupyter Notebook с полным кодом, расчётами и визуализациями
