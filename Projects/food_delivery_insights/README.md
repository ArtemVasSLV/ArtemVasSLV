# Поиск инсайтов и точек роста для сервиса доставки еды «Всё.из.кафе»

## Описание проекта
Сервис доставки еды «Всё.из.кафе» столкнулся с необходимостью повышения удержания пользователей и улучшения взаимодействия с партнёрами-ресторанами. Цель проекта — найти инсайты, которые позволят сервису расти и развиваться.

**Задачи исследования:**
- Изучить пользовательский путь и проанализировать конверсии через воронки
- Сегментировать пользователей с помощью RFM-модели для оценки лояльности
- Кластеризовать рестораны методом K-Means для выделения групп с разными моделями работы
- Сформулировать рекомендации по удержанию пользователей и работе с партнёрами

## Навыки и инструменты
- **Python:** Pandas, NumPy — обработка и анализ данных
- **Визуализация:** Matplotlib, Seaborn
- **Машинное обучение:** Scikit-learn (KMeans)
- **Анализ данных:** RFM-сегментация, воронки конверсии, кластерный анализ

## Набор данных
**`тут_была_ссылка`** — данные о посещениях и заказах в сервисе доставки:
- `visitor_uuid` — идентификатор посетителя
- `user_id` — идентификатор зарегистрированного пользователя
- `device_type` — тип платформы (Mobile, Desktop)
- `city_id` — город
- `source` — рекламный источник
- `first_date` — дата первого посещения
- `visit_id` — идентификатор сессии
- `event` — тип события (authorization, main_page, reg_page, confirm_phone, object_page, add_to_cart, order и др.)
- `datetime` — дата и время события
- `rest_id` — идентификатор ресторана
- `object_id` — идентификатор блюда
- `order_id` — идентификатор заказа
- `revenue` — выручка от заказа
- `delivery` — стоимость доставки
- `commission` — комиссия сервиса

---

## План проекта

1. Загрузка данных и их предобработка
2. Анализ пользовательского пути новых пользователей (воронки)
3. RFM-сегментация пользователей
4. K-Means кластеризация ресторанов
5. Итоговый вывод и рекомендации

---

## Часть 1. Загрузка данных и их предобработка

**Выполненные операции:**
- Загружен датафрейм `df` (205 510 строк, 15 столбцов) с парсингом дат
- Проверены пропуски и дубликаты
- Полных дубликатов: 0
- Пропусков: 1 002 505 (естественные, связанные с разными типами событий)
- Приведены типы данных для `user_id`, `object_id`, `order_id` (целочисленные)

**Результат:** Данные готовы к анализу, пропуски оставлены без изменений как естественные для бизнес-логики.

---

## Часть 2. Анализ пользовательского пути

### Задача 2.1. Общая воронка пользователей

**Этапы воронки:**
authorization → main_page → reg_page → confirm_phone → object_page → add_to_cart → order

| Этап | Пользователи | Конверсия от первого шага | Конверсия от предыдущего |
|------|--------------|---------------------------|--------------------------|
| authorization | 7 796 | 100.0% | — |
| main_page | 6 835 | 87.7% | 87.7% |
| reg_page | 5 649 | 72.5% | 82.6% |
| confirm_phone | 4 347 | 55.8% | 77.0% |
| object_page | 3 530 | 45.3% | 81.2% |
| add_to_cart | 2 929 | 37.6% | 83.0% |
| order | 2 432 | 31.2% | 83.0% |

**Проблемные места:**
- Потеря 14% пользователей после первого шага (возможные проблемы с загрузкой)
- Просадка на переходе `reg_page → confirm_phone` (23% потерь)
- Просадка на переходе `confirm_phone → object_page` (19% потерь)

### Задача 2.2. Сравнение мобильной и десктопной версий

**Step-by-step конверсия по устройствам:**

| Этап | Mobile | Desktop |
|------|--------|---------|
| main_page | 83.0% | 90.4% |
| reg_page | 88.7% | 79.5% |
| confirm_phone | 54.7% | 90.2% |
| object_page | 71.4% | 84.7% |
| add_to_cart | 86.7% | 81.8% |
| order | 86.7% | 81.8% |

**Ключевые выводы:**
- **Mobile:** серьёзные проблемы на шаге подтверждения телефона (54.7%) — возможно, не приходят SMS или долгая загрузка
- **Desktop:** проблемы на шаге перехода к регистрации (79.5%) и чуть ниже конверсия в заказ
- Десктопная версия в целом стабильнее, что объясняет рост доли заказов с десктопа

---

## Часть 3. RFM-сегментация пользователей

### Задача 3.1. Расчёт RFM-показателей

Для каждого покупателя рассчитаны:
- **Recency** — дней с последней покупки (на 03.07.2021)
- **Frequency** — количество заказов
- **Monetary** — сумма трат

**Распределение показателей:**
- Recency: равномерное распределение от 0 до 60 дней
- Frequency: сильно смещено влево (большинство с 1-2 заказами)
- Monetary: смещено влево (большинство с небольшими суммами)

### Задача 3.2. Выделение RFM-сегментов

**Методика:**
- Recency: 3 равные группы (3 — самые недавние, 1 — самые давние)
- Frequency: 1 заказ → 1; 2 заказа → 2; 3+ заказов → 3
- Monetary: по 33-му и 66-му перцентилям

**Топ-10 сегментов по количеству пользователей:**

| Сегмент | Пользователей | Характеристика |
|---------|---------------|----------------|
| 212 | 296 | Средняя давность, 2 заказа, средний чек |
| 211 | 289 | Средняя давность, 2 заказа, низкий чек |
| 111 | 263 | Давние, 1 заказ, низкий чек |
| 112 | 261 | Давние, 1 заказ, средний чек |
| 311 | 255 | Недавние, 1 заказ, низкий чек |
| 213 | 237 | Средняя давность, 2 заказа, высокий чек |
| 312 | 234 | Недавние, 1 заказ, средний чек |
| 313 | 187 | Недавние, 1 заказ, высокий чек |
| 113 | 160 | Давние, 1 заказ, высокий чек |
| 223 | 56 | Средняя давность, 3+ заказа, высокий чек |

**Сегменты-«киты»** (малочисленные, но ценные):
- 333 (33 пользователя) — недавние, частые, дорогие
- 323 (35 пользователей) — недавние, частые, средний чек
- 233 (46 пользователей) — средняя давность, частые, дорогие

### Рекомендации по сегментам:

**Премиум-клиенты (333, 323, 233, 313, 213):**
- VIP-условия, эксклюзивные предложения
- Персональный менеджер
- Ранний доступ к новинкам
- Специальные события и дегустации

**Активные клиенты с потенциалом (312, 311, 212, 211):**
- Программы лояльности
- Персонализированные рекомендации
- Стимулирование к увеличению частоты заказов
- Акции "Приведи друга"

**Неактивные клиенты (111, 112, 113):**
- Пробуждающие кампании
- Промокоды "Вернись к нам"
- Напоминания о лучших предложениях
- Спецпредложения на любимые блюда

---

## Часть 4. K-Means кластеризация ресторанов

### Задача 4.1. Подготовка данных

Для каждого ресторана рассчитаны:
- Общее количество заказов
- Средняя стоимость заказа
- Общее число заказанных уникальных блюд (ассортимент)

**Топ ресторанов по среднему чеку:**

| rest_id | Заказы | Средний чек | Уникальных блюд |
|---------|--------|-------------|-----------------|
| 55d64707... | 5 | 4 754.40 | 2 |
| 8d4f8073... | 163 | 4 561.14 | 3 |
| a29747e1... | 94 | 3 565.39 | 9 |
| 43e40bac... | 43 | 3 313.06 | 6 |
| 4a693ca5... | 107 | 2 989.59 | 12 |

### Задача 4.2. Определение оптимального количества кластеров

Методом «локтя» определено оптимальное количество кластеров: **3**

### Задача 4.3. Кластеризация и анализ результатов

**Средние значения по кластерам:**

| Кластер | Заказы | Средний чек | Уникальных блюд | Характеристика |
|---------|--------|-------------|-----------------|----------------|
| **Кластер 1** | 165.7 | 1 964.2 | 15.5 | Бюджетные, массовые |
| **Кластер 2** | 199.0 | 2 974.7 | 18.6 | Средний сегмент |
| **Кластер 3** | 84.0 | 4 657.8 | 2.5 | Премиальные, специализированные |

#### Кластер 1 — «Бюджетные / Масс-маркет»
- Низкий средний чек (~1964 руб.)
- Умеренное количество заказов
- Широкий ассортимент (15-16 блюд)
- Вероятно, рестораны быстрого питания, столовые

**Рекомендации:**
- Помощь в создании комбо-наборов и сетов для повышения среднего чека
- Оптимизация логистики для быстрой доставки
- Маркетинговое позиционирование как «быстрых и недорогих» решений
- Сниженная комиссия за объём

#### Кластер 2 — «Золотая середина»
- Высокое количество заказов (199)
- Средний чек (~2975 руб.)
- Самый широкий ассортимент (18-19 блюд)
- Основной источник выручки, стабильные партнёры

**Рекомендации:**
- Совместные маркетинговые акции (разделение затрат 50/50)
- Гибкие условия комиссии за объём
- Предоставление аналитики спроса для оптимизации меню
- Тестирование новых блюд на этой группе

#### Кластер 3 — «Премиальные / Специализированные»
- Высокий средний чек (~4658 руб.)
- Небольшое количество заказов (84)
- Узкий ассортимент (2-3 блюда)
- Рестораны высокой кухни, специализированные заведения

**Рекомендации:**
- Минимальная комиссия (8-10%) за сохранение эксклюзивности
- Специальная премиум-упаковка
- Позиционирование как «премиум» в приложении
- Организация специальных событий и дегустаций

---

## Итоговые выводы и рекомендации

### 1. Проблемные места в пользовательском пути

**Основные потери пользователей:**
- 14% теряются после первого шага — возможны проблемы с загрузкой
- 23% теряются на шаге `reg_page → confirm_phone` (особенно на mobile — 45.3% потерь!)
- 19% теряются на шаге `confirm_phone → object_page`

**По устройствам:**
- **Mobile:** критическая проблема с подтверждением телефона (конверсия всего 54.7%). Срочно проверить доставку SMS, время ожидания, работу API.
- **Desktop:** ниже конверсия в регистрацию и оформление заказа

**Действия:**
1. Провести технический аудит мобильной версии, особенно процесса подтверждения телефона
2. Оптимизировать время загрузки страниц
3. Упростить процесс регистрации (возможно, через соцсети)
4. Внедрить отслеживание ошибок на критических этапах

### 2. RFM-сегментация: три типа клиентов

| Тип | Доля | Характеристика | Стратегия |
|-----|------|----------------|-----------|
| **Премиум-клиенты** | ~20% | Сегменты 333, 323, 233, 313, 213. Частые заказы, высокий чек | VIP-условия, эксклюзивы, персональный подход |
| **Активная база** | ~35% | Сегменты 312, 311, 212, 211. Регулярные заказы, средний чек | Программы лояльности, стимулирование к росту |
| **Неактивные / Новые** | ~45% | Сегменты 111, 112, 113. 1-2 заказа, давно не заказывали | Пробуждающие кампании, промокоды, напоминания |

### 3. Кластеризация ресторанов: три модели работы

| Кластер | Доля | Характеристика | Стратегия работы |
|---------|------|----------------|------------------|
| **Кластер 1 (Бюджетные)** | ~40% | Низкий чек (~1964 руб.), широкий ассортимент | Комбо-наборы, сниженная комиссия за объём, оптимизация доставки |
| **Кластер 2 (Массовые)** | ~35% | Средний чек (~2975 руб.), максимум заказов (199) | Совместные акции 50/50, аналитика спроса, тестирование новинок |
| **Кластер 3 (Премиальные)** | ~25% | Высокий чек (~4658 руб.), узкий ассортимент (2-3 блюда) | Минимальная комиссия, премиум-позиционирование, спецсобытия |

### 4. Общие рекомендации бизнесу

**По продукту:**
1. Срочно исправить технические проблемы в мобильной версии (подтверждение телефона)
2. Оптимизировать воронку, особенно на критических этапах
3. Внедрить A/B-тестирование изменений

**По клиентам:**
1. Запустить персонализированные кампании для каждого RFM-сегмента
2. Разработать программу лояльности с уровнями (бронза, серебро, золото)
3. Внедрить систему триггерных коммуникаций (брошенная корзина, напоминания)

**По ресторанам:**
1. Разработать индивидуальные условия сотрудничества для каждого кластера
2. Предоставлять ресторанам аналитику по их эффективности
3. Создать программу развития для ресторанов 1-го кластера (помощь в росте)
4. Для премиум-ресторанов разработать эксклюзивные условия и позиционирование

### 5. Финансовый эффект

Реализация предложенных мер позволит:
- Увеличить конверсию в заказ на 5-7% за счёт исправления воронки
- Повысить LTV премиум-клиентов на 15-20%
- Увеличить средний чек в бюджетном сегменте на 10-12%
- Привлечь новых ресторанов за счёт гибких условий

---

## Файлы
- `README.md` — описание проекта
- `analysis_kafe.ipynb` — Jupyter Notebook с полным кодом и визуализациями
