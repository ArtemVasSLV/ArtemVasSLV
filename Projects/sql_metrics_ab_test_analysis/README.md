# Расчёт метрик в SQL и анализ A/B-тестирования

## Описание проекта
Проект состоит из двух частей. В первой части проводится анализ данных сервиса Яндекс Книги, расчёт метрик и проверка гипотезы о различиях в активности пользователей из Москвы и Санкт-Петербурга. Во второй части анализируются результаты A/B-тестирования нового интерфейса интернет-магазина BitMotion Kit.

**Цель исследования:**
- Рассчитать ключевые метрики сервиса Яндекс Книги и интерпретировать результаты
- Проверить гипотезу о различиях в активности пользователей Москвы и Санкт-Петербурга
- Оценить корректность проведения A/B-теста и проанализировать его результаты

## Навыки и инструменты
- **Python:** Pandas, Matplotlib, SciPy, StatsModels
- **Статистика:** A/B-тестирование, U-тест Манна-Уитни, Z-тест для пропорций
- **Метрики:** MAU, LTV, Retention Rate, конверсия

---

## Часть 1. Яндекс Книги: анализ метрик и проверка гипотезы

### Набор данных
Данные о чтении и прослушивании контента в сервисе Яндекс Книги за период с 1 сентября по 11 декабря 2024 года.

**Таблицы:**
- `bookmate.audition` — активность пользователей (сессии, длительность, тип контента)
- `bookmate.content` — информация о контенте (авторы, жанры, длительность)
- `bookmate.author` — данные об авторах
- `bookmate.geo` — данные о местоположении пользователей

### Ключевые результаты (по данным SQL)

| Вопрос | Ответ |
|--------|--------|
| Какой автор собрал больше всего уникальных читателей и слушателей в ноябре? | **Андрей Усачёв** (MAU = 7 107) |
| Что объединяет три самых популярных произведения в ноябре? | **Все они написаны для детей** |
| На какой день активности возвращаемость пользователей была минимальной? | **Пятый день** (Retention Rate = 47%) |
| Как можно описать данные по пользователям в Москве и Санкт-Петербурге? | **В Москве больше пользователей, и их средний LTV выше** |
| Как менялась средняя выручка за час чтения/прослушивания? | **Средняя выручка за час активности падает** |

### Проверка гипотезы

**Гипотеза:** пользователи из Санкт-Петербурга проводят в среднем больше времени за чтением и прослушиванием книг, чем пользователи из Москвы.

**Метод:** U-тест Манна-Уитни (односторонний)

**Результаты:**
- Размер выборки после очистки: 8 540 пользователей
- Москва: 6 234 пользователя, Санкт-Петербург: 2 306 пользователей
- **p-value = 0.619** (> 0.05)

**Вывод:** Статистически значимых различий в активности пользователей между Москвой и Санкт-Петербургом не обнаружено.

### Аналитическая записка

**Выбранный тест:** U-тест Манна-Уитни (не требует нормальности распределения, устойчив к выбросам)

**Уровень значимости:** α = 0.05

**Результат:** p-value = 0.619

**Интерпретация:** Полученное значение p-value значительно превышает критический уровень значимости, что не позволяет отвергнуть нулевую гипотезу. Различий во времени активности между пользователями Москвы и Санкт-Петербурга не обнаружено.

**Возможные причины:**
1. Схожесть городов — оба являются крупными мегаполисами с похожим ритмом жизни
2. Недостаточный объём выборки для обнаружения малых эффектов
3. Наличие конкурирующих приложений

---

## Часть 2. Анализ A/B-тестирования интернет-магазина BitMotion Kit

### Набор данных

**`тут_была_ссылка`** — участники тестов:
- `user_id`, `group`, `ab_test`, `device`

**`тут_была_ссылка`** — события 2020 года:
- `user_id`, `event_dt`, `event_name`, `details`

### Техническое задание теста

**Гипотеза:** Упрощение интерфейса приведёт к тому, что в течение 7 дней после регистрации конверсия зарегистрированных пользователей в покупателей увеличится как минимум на 3 процентных пункта.

**Параметры теста:**
- Название: `interface_eu_test`
- Группы: A (контрольная), B (новый интерфейс)

### 1. Проверка корректности проведения теста

| Параметр | Результат |
|----------|-----------|
| Пересечения с конкурирующим тестом | Удалено 887 пользователей |
| Распределение по группам | A: 49.7%, B: 50.3% |
| Пересечения между группами | 0 пользователей |
| Распределение по устройствам | Сбалансировано |

### 2. Анализ пользовательской активности

- Всего событий у пользователей теста: 68 074
- Событий в первые 7 дней после регистрации: 58 692
- Требуемый размер группы (по калькулятору Миллера): 3 692
- Фактический размер: A — 4 952, B — 5 011 (выборка достаточна)

### 3. Конверсия в покупку

| Группа | Покупатели | Всего пользователей | Конверсия |
|--------|------------|---------------------|-----------|
| A | 1 377 | 4 952 | **27.8%** |
| B | 1 480 | 5 011 | **29.5%** |

- Абсолютный прирост: **+1.7 п.п.**
- Относительный прирост: **+6.12%**

### 4. Статистическая проверка гипотезы

**Гипотезы:**
- **H₀:** Конверсия в группе B не выше, чем в группе A
- **H₁:** Конверсия в группе B выше, чем в группе A

**Метод:** Z-тест для пропорций (односторонний)

**Результат:** **p-value = 0.028** (< 0.05)

**Вывод:** Отвергаем нулевую гипотезу. Конверсия в группе B статистически значимо выше, чем в группе A.

### 5. Итоговые выводы по A/B-тесту

1. **Корректность проведения теста:** тест проведён корректно, группы сбалансированы
2. **Результаты:** 
   - Конверсия в тестовой группе: **29.5%**
   - Конверсия в контрольной группе: **27.8%**
   - Абсолютный прирост: **+1.7 п.п.** (целевой показатель +3 п.п. не достигнут)
3. **Статистическая значимость:** p-value = 0.028 — различия статистически значимы
4. **Рекомендация:**
   - Несмотря на статистическую значимость, целевой показатель не достигнут
   - Внедрение нового интерфейса на данном этапе **не рекомендуется**
   - Для достижения целевых показателей требуется доработка интерфейса и повторное тестирование

---

## Общий вывод по проекту
В ходе проекта были решены две аналитические задачи:
1. Проведён анализ метрик сервиса Яндекс Книги, выявлены ключевые тренды и проверена гипотеза о различиях в активности пользователей двух столиц (гипотеза не подтвердилась).
2. Выполнен анализ A/B-теста нового интерфейса интернет-магазина: тест проведён корректно, получен статистически значимый прирост конверсии (+1.7 п.п.), однако целевой показатель (+3 п.п.) не достигнут, что требует дальнейших улучшений.

## Файлы
- `README.md` — описание проекта
- `analysis.ipynb` — Jupyter Notebook с полным кодом и визуализациями
