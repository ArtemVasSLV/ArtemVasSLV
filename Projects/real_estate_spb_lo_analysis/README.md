# Анализ рынка недвижимости Санкт-Петербурга и Ленинградской области

## Описание проекта
Проект выполнен для агентства недвижимости из Петрозаводска, которое планирует выйти на рынок Санкт-Петербурга и Ленинградской области. Заказчику требуется анализ объявлений о продаже жилой недвижимости для определения наиболее перспективных сегментов и разработки эффективной бизнес-стратегии.

**Цель проекта:** Провести комплексный анализ рынка недвижимости, выявить сегменты с высоким спросом, определить сезонные тенденции и подготовить интерактивный дашборд для оперативной работы с клиентскими запросами.

## Навыки и инструменты
- **SQL (PostgreSQL):** написание сложных запросов, CTE, оконные функции, работа с датами
- **Визуализация данных:** Yandex DataLens
- **Базы данных:** DBeaver, подключение к внешней БД
- **Аналитика:** фильтрация выбросов, перцентили, сегментация, когортный анализ

## Структура данных
Проект выполнен на базе данных `data-analyst-estate`, схема `real_estate`. Данные содержат архив объявлений сервиса Яндекс Недвижимость о продаже квартир в Санкт-Петербурге и Ленинградской области за несколько лет.

### Таблицы:

| Таблица | Описание | Ключевые поля |
|---------|----------|---------------|
| `advertisement` | Информация об объявлениях | `id`, `first_day_exposition`, `days_exposition`, `last_price` |
| `flats` | Информация о квартирах | `id`, `city_id`, `type_id`, `total_area`, `rooms`, `ceiling_height`, `floors_total`, `floor`, `balcony` |
| `city` | Информация о городах | `city_id`, `city` |
| `type` | Типы населённых пунктов | `type_id`, `type` |

**Связи между таблицами:**
- `advertisement.id` → `flats.id`
- `flats.city_id` → `city.city_id`
- `flats.type_id` → `type.type_id`

---

## Этапы работы

### 1. Разведочный анализ данных (EDA)
Первичное знакомство с данными в DBeaver позволило выявить ключевые характеристики:

| Параметр | Значение |
|----------|----------|
| Период данных | 2014-11-27 — 2019-05-03 |
| Всего объявлений | ~23 500 |
| Доля объявлений в Санкт-Петербурге | 66.47% |
| Типы населённых пунктов | 10 |
| Доля объявлений в городах | ~85% |
| Доля снятых с публикации объявлений | 86.55% |
| Медианное время продажи | 95 дней |
| Среднее время продажи | 180.75 дней |

**Проблемы в данных:**
- Аномально высокие значения (выбросы) по общей площади, количеству комнат, высоте потолков
- Нереалистично низкие значения (например, высота потолков 1 метр)
- Экстремальные значения стоимости квадратного метра (от 112 ₽ до 1.9 млн ₽)

**Решение:** Для корректного анализа использована фильтрация данных по перцентилям (1-й и 99-й) для исключения выбросов.

---

### 2. Решение ad hoc задач (SQL)

#### Задача 1. Время активности объявлений

**Цель:** Определить, какие типы квартир продаются быстро, а какие остаются активными долго.

**Методология:**
- Объявления разделены на категории по времени активности:
  - 1-30 дней (до месяца)
  - 31-90 дней (1-3 месяца)
  - 91-180 дней (3-6 месяцев)
  - 181+ дней (более полугода)
  - non category (не снятые с продажи)
- Анализ проведён отдельно для Санкт-Петербурга и городов Ленинградской области
- Использованы данные только за полные годы (2015-2018)

**Ключевые выводы:**

| Регион | Самая частая категория | Характеристики быстро продаваемых |
|--------|------------------------|-----------------------------------|
| Санкт-Петербург | 31-90 дней | Меньшая площадь, ниже цена за м², 1-2 комнаты |
| Ленинградская область | 91-180 дней | Большая площадь, выше цена за м², больше комнат |

**Различия между регионами:**
- В Санкт-Петербурге недвижимость продаётся быстрее (медиана 85 дней против 112 в ЛО)
- В Ленобласти выше доля объявлений, активных более полугода
- Наличие балкона значимо влияет на скорость продажи в обоих регионах

---

#### Задача 2. Сезонность объявлений

**Цель:** Выявить периоды повышенной активности продавцов и покупателей.

**Методология:**
- Проанализированы месяцы публикации и снятия объявлений за 2015-2018 годы
- Рассчитаны количество объявлений, средняя цена м² и средняя площадь по месяцам

**Ключевые выводы:**

| Показатель | Пик активности | Спад активности |
|------------|----------------|-----------------|
| Публикация объявлений | Март, Сентябрь | Январь, Май |
| Снятие объявлений (продажи) | Апрель, Октябрь | Январь, Июль |

**Закономерности:**
- Пики публикаций опережают пики продаж на 1 месяц
- Весенний и осенний сезоны — наиболее активные периоды
- Зимой (особенно в январе) активность минимальна
- Средняя цена м² и площадь квартир стабильны в течение года, без ярко выраженной сезонности

**Рекомендация для заказчика:** Планировать маркетинговые кампании на февраль и август, чтобы захватить пиковые периоды спроса в марте и сентябре.

---

### 3. Доработка дашборда в Yandex DataLens

#### Вкладка «Аналитика рынка недвижимости»

**Добавленные элементы:**

1. **Фильтр по типам населённых пунктов** — позволяет пользователям выбирать интересующие типы (город, посёлок, деревня и т.д.)

2. **Показатель «Средняя площадь»** — даёт представление о стандартных размерах квартир

3. **Метрика «Среднее количество дней продажи»** — визуализирована диаграммой с областями для симметрии с соседними метриками

4. **Чарт «Топ-5 по количеству дней продажи»** — населённые пункты с минимальным средним временем продажи, с цветовым выделением:
   - Зелёный — самые быстрые продажи
   - Жёлтый — средние
   - Красный — более медленные среди топ-5

5. **Фильтр гранулярности** (параметр) — позволяет детализировать данные по:
   - дням
   - неделям
   - месяцам
   - годам
   
   Фильтр применяется к трём графикам: «Количество квартир», «Средняя цена квартиры», «Среднее количество дней продажи»

#### Вкладка «Детализация рынка»

**Доработки:**

1. **Замена city_id на название города** — в таблице теперь отображаются понятные названия населённых пунктов

2. **Сортировка по средней стоимости м²** — от дорогих к дешёвым с градиентной заливкой:
   - Красный — самые дорогие
   - Жёлтый — средние
   - Зелёный — самые дешёвые

3. **Замена круговых диаграмм на столбчатые** для показателей:
   - Средняя стоимость м² в зависимости от планировки
   - Средняя стоимость м² по типу жилья

4. **Новые признаки** — наличие водоёма или парка в радиусе 3 км, визуализированы столбчатыми диаграммами

5. **Анализ дней недели** — выявлен самый активный день публикации объявлений (зелёный), наименее активный (красный), остальные (жёлтые)

6. **График сезонности по годам** — линии по годам (2015-2018) показывают динамику количества объявлений по месяцам, позволяя увидеть:
   - Общие сезонные паттерны
   - Аномальные годы
   - Тренды роста/падения активности

---

## Ключевые выводы и рекомендации для заказчика

### 1. Выбор сегмента для выхода на рынок
**Рекомендуемый сегмент:** 1-2 комнатные квартиры в Санкт-Петербурге площадью 35-50 м²

**Обоснование:**
- Этот сегмент продаётся быстрее всего (медиана 85 дней)
- Наибольший объём предложения
- Стабильный спрос в течение всего года

### 2. Сезонность и маркетинг
**Оптимальное время для выхода:** Февраль-март

**Обоснование:**
- Пик публикаций в марте — возможность сразу захватить поток продавцов
- Пик продаж в апреле — быстрая конверсия для первых клиентов
- Второй оптимальный период: Август-сентябрь

### 3. Географический фокус
**Приоритет:** Санкт-Петербург (66% рынка)
**Вторичный фокус:** Крупные города Ленобласти (Гатчина, Всеволожск, Выборг)

### 4. Особенности ценообразования
- Наличие балкона увеличивает скорость продажи
- Близость парков и водоёмов повышает стоимость м² на 8-12%
- Этаж (не первый и не последний) — наиболее ликвидный вариант

### 5. Рекомендации по дашборду для работы с клиентами
Использовать созданный дашборд для:
- Быстрого подбора объектов по параметрам (фильтры)
- Демонстрации клиентам рыночных тенденций
- Обоснования ценообразования
- Прогнозирования сроков продажи

---

## Файлы
- `README.md` — описание проекта
- `sql_queries.sql` — SQL-запросы для решения ad hoc задач
- `conclusions.docx` — аналитические выводы
- `dashboard_link.txt` — ссылка на дашборд
